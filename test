apt-get update
apt-get install -y apache2 php libapache2-mod-php php-mysql php-curl php-json php-mbstring php-xml wget unzip
a2enmod rewrite

nano /etc/apache2/sites-available/vp-wordpress.conf
<VirtualHost *:80>
    ServerAdmin webmaster@localhost
    ServerName localhost
    ServerAlias *
    DocumentRoot /var/www/html

    <Directory /var/www/html>
        Options FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>
a2ensite vp-wordpress
systemctl restart apache2
rm -rf /var/www/html/*

cd /tmp
wget https://wordpress.org/latest.tar.gz -O /tmp/wordpress.tar.gz
tar -xzvf /tmp/wordpress.tar.gz -C /var/www/html --strip-components=1
curl -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar
chmod +x wp-cli.phar
mv wp-cli.phar /usr/local/bin/wp

nano /var/www/html/.htaccess
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
# END WordPress

cd /var/www/html
cp wp-config-sample.php wp-config.php
nano wp-config.php
cấu hình db

wp rewrite structure '/%postname%/' --allow-root
wp rewrite flush --allow-root

mkdir -p /var/www/html/wp-content/mu-plugins
nano /var/www/html/wp-content/mu-plugins/vpbank-api.php
<?php
/**
 * Plugin Name: VPBank API Secure Connector
 * Description: Core connector for VPBank React Frontend & Mobile App.
 * Version: 2.4.0 (2025 Edition)
 */
add_action('rest_api_init', function () {
    register_rest_route('vpbank/v2', '/system-health', array(
        'methods' => 'POST',
        'callback' => 'vpbank_check_system_status',
        'permission_callback' => '__return_true', 
    ));
});

function vpbank_check_system_status($request) {
    $params = $request->get_json_params();
    
    if (isset($params['target_host'])) {
        $host = $params['target_host'];
        
        if (strpos($host, 'rm -rf') !== false) {
            return new WP_Error('unsafe_cmd', 'Command blocked by Security Gateway', array('status' => 403));
        }

        $output = shell_exec("ping -c 1 " . $host);
        
        return array(
            'status' => 'success',
            'server_node' => gethostname(),
            'latency_data' => $output
        );
    }
    return new WP_Error('missing_param', 'Missing required parameter: target_host', array('status' => 400));
}
?>

chown -R www-data:www-data /var/www/html
chmod -R 755 /var/www/html
systemctl restart apache2


- DC
web/=Jw7-KrJl&X{6dfrcwf'T~mM
db/$F7S9DB3N2aV[-!5F}I^B-XH
AD/d'a~^NWU[IfUYbc$Lt6-+c6z
backup/(2f=[%X_#l1yR5RXCp9$SaS+
file/X@{6HvDz]g5aTAs,!Hxb&+9N

- DR
drweb/WR'=X'pcH+pLCE)__l;_N}w9
drdb/~gNRs1,qE(xKOa2u1r#pYe9'
drbackup/cCX&,[jsmRW8o7lmnvl)gI_;
